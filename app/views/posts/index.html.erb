
<% if @posts.any? %>

  <%= render 'post_view_select' if logged_in? %>
  <%= render 'post_stats' if logged_in? %>
  
  <% @posts.each_with_index do |post, i|%>
    <div class="col-md-8 offset-md-2 ">
      <div class="card border-<%= border_color(i) %> mb-4 text-center">
        <div class="card-header d-flex justify-content-between">
          <div class="author">by / <%= logged_in? ? post.user.username : post.user.hidden_name  %></div>
          <div class="time">           
            <% if logged_in? %>
              <%= time_ago_in_words(post.created_at) %> ago
            <% end %>
          </div>
        </div>
        <div class="card-body">
          <h2 class="post-heading"><%= post.title %></h2>
          <h4 class="card-title"><%= (@posts_count.to_i - post.id) + 1 %></h4>
          <p class="card-text"><%= post.body %></p>
        </div>
      </div>
    </div>
  <% end %>

  <% if @view == 'paginated' %>
    <%= render 'post_pagination_nav' %>
  <% elsif @view == 'story' %>
    <%= render 'post_arrow_nav' %>
  <% end %>

<% end %>


<script type="text/javascript">

  var viewBtn = document.querySelector('.view-btn');
  var params = new URLSearchParams(window.location.search);
  var view = params.get('view') || 'paginated';
  var viewOption = document.querySelector(`[value=${view}]`)
  viewOption.checked = true;

  $('.view-option').on("change", function() {
     viewBtn.search = '?view=' + this.value
  });

</script>
